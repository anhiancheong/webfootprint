import java.io.File;
import java.io.FileReader;
import java.io.IOException;
import java.io.Reader;
import java.util.ArrayList;
import java.util.HashMap;

import org.json.JSONArray;
import org.json.JSONObject;
import org.json.JSONTokener;

import com.coretruth.Constants;



/** Each coreExperiment represents a new experiment on the data. Each experiment has unique parameters concerning
 * the websites used, the initial set of information and the various confidence and probability thresholds
 * an experiment is capable of loading the relevant information from a config file 
 * */
public class CoreExperiment {

	
	public double confidenceThreshold = 0.0;
	
	public double aggregateThreshold = 0.0;
	
	public double websiteThreshold = 0.0;
	
	public int experimentID = -1;
	
	/**websitesUsed is a hash map of the possible websites that an experiment could use
	 * each index in the website will look like <googleplus, true>,....
	 * */
	//HashMap<String, Boolean> websitesUsed = new HashMap<String, Boolean>();
	
	/**Arraylist stores the websites being used in this experiment*/
	ArrayList<String> websites = new ArrayList<String>();
	
	/**This is a data strucutre to hold the various cores involved with the experiment.
	 * There is a core of the initial values, an individual core for each website and a final aggregated core
	 * */
	//ArrayList? HashMap?
	//Should each inference procedure be done in another core, or through a method in this class...
	//Each end up being pretty different and it may be better to have a specialized method instead of having
	//a core method with tons of cases and statements
	
	/**These variable hold the first name and last name of the person being examined. Other attribute may be added,
	 * but the names are a minimum for the program to even function therefore are hardcoded */
	public String first_name = "";
	public String last_name = "";
	
	/**These two booleans handle cases for looking at expected values or not*/
	public boolean considerTweets = false;
	public boolean linkedinExtracted = false;
	
	/** This array holds a list of the additional initial attributes that this experiment expects
	 * */
	ArrayList<String> initialAttributes = new ArrayList<String>();
	
	
	/** This method will read a json configured file and load the various run parameters
	 * */
	public void loadConfig(String filename) {
		try {
			Reader read = null;
			read = new FileReader(new File(filename));
			JSONTokener jsonReader = new JSONTokener(read);
			JSONObject params = new JSONObject(jsonReader);
			/*
			 * Reading in configuration information from the file, things like confidence, merging thresholds etc
			 * */
			System.out.println(params.toString(3));

			confidenceThreshold = (float) params.getDouble("confidenceThreshold_forYifang");
			
			aggregateThreshold = (float) params.getDouble("aggregateThreshold");
			
			websiteThreshold = (float) params.getDouble("individualWebsiteThreshold");
			
			experimentID = params.getInt("experimentId");
			
			linkedinExtracted = params.getBoolean("considerLinkedinExtractedAttrs");
			
			considerTweets = params.getBoolean("considerTweets");
			
			//Getting which websites this experiment will seek to use
			JSONArray temp = params.getJSONArray("websites");

			for (int i = 0; i < temp.length(); i++) {
				websites.add(temp.getString(i));
			}

			

			//Gets the attirbutes for the initial core
			ArrayList<String> initialCoreAttrs = new ArrayList<String>();
			JSONArray tempInit = params.getJSONArray("initialCoreAttributes");

			for (int i = 0; i < tempInit.length(); i++) {
				if (tempInit.getString(i).equals("last_name") || tempInit.getString(i).equals("first_name"))
					continue;
				
				initialAttributes.add(tempInit.getString(i));
			}

			
		}//end of try block
		catch(IOException ie){
			ie.printStackTrace();
		}
	
	
	}
	
}//end of class
